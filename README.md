# 色織まいは お茶会用アラームアプリ

_※本アプリは未遂に終わっております。アラーム設定マスタのCRUD機能のみ動作させることが可能です。_

本アプリ作りを通して得られた知見と反省は拙ブログ「まどろみみっくろん」で記事に起こしています。
気になる方は下記リンクより確認をお願い致します。

[お茶会用アラーム作りの始末書](https://madoromimicron.com/2022/09/24/maiha_alarm_apology/)

## 概要
まどおーむ代表　うおとホタルと申します。
本アプリは色織まいはさんがお茶会の時刻を忘れないことを目的にLINEやSlack等のメッセージアプリに時刻を通知させる予定でした。
結果的にはアラーム設定マスタのみの実装に留まりました。
アラーム設定マスタでは通知時刻を登録することができます。編集・削除機能も実装しました。

ESP32andDS3231というフォルダにはArduino ESP32で書き込むためのファイルがございます。
Arduino IDEからこのファイルを書き込んだときに次の処理が行われます。
1. ESP32をネット（Wi-Fi）に接続してNTPサーバから現在時刻を取得する。
2. 取得した時間をDS3231 RTC(リアルタイムクロックモジュール)にセットする。
3. セットした時間をESP32に送信してシリアルモニタに表示させる。


## 動作環境
自分が本アプリを動作させた環境です。
- PHP：8.0.20
- PostgreSQL：14.3

## スクリーンショット
![maiha_alarm_screenshot](https://user-images.githubusercontent.com/102233603/192121615-65472a84-221f-4e1e-a61a-56a011b50d4f.JPG)

## 使い方
1. appディレクトリの直下にdatabase.phpを追加してください。database.phpの記入例は[こちら](https://github.com/HotaruHarbor51/MaihaAlarmApp4/issues/3#issue-1384834208)です。ご自身の環境に合わせて値を変更してください。
2. ローカル環境で動かす場合はそのままの構成でご利用ください。本番環境で動かす場合はapp以下のファイルを本アプリのルートとなるディレクトリに置いてください。
3. トップ画面からアラーム設定マスタのリンクをクリックしますと一覧画面が開きます。
4. 一覧画面にある「新規作成」ボタンをクリックしますと通知設定を登録することができます。一覧画面にある編集ボタン、削除ボタンからアラーム設定の編集、削除を行うことができます。

## テーブル構成

テーブル名：scheduletimes

| カラム名 |型| 長さ | NOT NULL | 備考|
|-------|----------|----------|----------|----------|
|id | bigint | | true | Primary Key |
|title | character varying | 100| true | タイトル |
|noticetime | timestamp without time zone | | true | 通知時刻 |
|advancenotice | integer | | | 事前通知(単位は分、規定値は0) |
|advancetime | timestamp without time zone | | | 事前通知時間(通知時刻から事前通知(分)を引いた時間) |
|description | character varying | 500 | | 説明 |
|notification_method | character varying | 20 | true | 通知方法 |
|uuid | character varying | 255 | | LINEのUUID |
|email | character varying | 255 | | メールアドレス |

## Arduino ESP32 回路図
![ESP32andDS3231_ブレッドボード](https://user-images.githubusercontent.com/102233603/192121241-561c4b20-89db-45a1-b3e9-71c5662bc41b.jpg)
![ESP32andDS3231_回路図](https://user-images.githubusercontent.com/102233603/192121243-3da55be2-bb90-4c47-9207-fda11720d140.jpg)

## 本アプリで実装したかった機能（未実装機能）
- テーブルから通知時刻を過ぎているデータを取得する機能
- 上記のデータをESP32に送信する機能
- ESP32からLINE Notifyを使って通知させる機能
- 利用者が通知ログを確認できる機能

## 今後の計画
今後少なくとも半年は個人開発を行うことがありません。
理由は開発のさなか魚戸ホタルたち「まどろみみっく」と関わりあう時間が減り、彼らの不興を買ったためです。
自分は彼らが大好きです。
自分とは分かり合えない、けれどいつの時代もありのまま生きている存在をまどろみみっくと呼んでいます。

自分は信用を得るために、責務を果たすためにチーム経営責任者になりたいと思いました。そこで2022年10月から簿記3級試験に挑戦します。
11月20日が試験日なので、そこに向けて計画を立てます。
この試験を合格すると数字の見れる経営者に一歩近づきます。
今後とも応援よろしくお願いします。

## 締めの言葉
色織まいはさん、お茶会用アラーム作りが完遂できず申し訳ございませんでした。
今後はあなたとも、仲の良い魚戸ホタルとも一緒の景色を見たいと思っています。
未熟な私ですが、今後ともよろしくお願いいたします。

これにて7月1日から9月25日まで続いたアラーム作りを締めとします。
お疲れさまでした。
